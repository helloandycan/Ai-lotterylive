<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>PowerLottery AI v2.8 - Multi-Color Heatmap</title>
    <style>
        :root { --dark-bg: #02050a; --terminal-blue: #00d2ff; }
        body { background-color: var(--dark-bg); color: #fff; font-family: 'Consolas', 'Courier New', monospace; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
        .terminal-container { width: 95%; max-width: 900px; border: 1px solid #1a2a44; padding: 25px; background: rgba(5, 10, 20, 0.95); box-shadow: 0 0 40px rgba(0, 150, 255, 0.2); }
        
        /* 彩色熱力圖 */
        .heatmap-container { display: grid; grid-template-columns: repeat(10, 1fr); gap: 6px; margin: 20px 0; padding: 10px; background: #000; border-radius: 4px; }
        .heat-node { height: 40px; display: flex; align-items: center; justify-content: center; font-size: 0.9rem; font-weight: bold; border-radius: 2px; border: 1px solid #111; transition: all 0.4s; color: #444; }
        
        /* 顏色分級 */
        .heat-extreme { background: #ff0000; color: #fff; box-shadow: 0 0 10px #ff0000; border-color: #ffaaaa; } /* 極熱 */
        .heat-high { background: #ffaa00; color: #000; box-shadow: 0 0 8px #ffaa00; }    /* 高熱 */
        .heat-mid { background: #00ff44; color: #000; }     /* 常態 */
        .heat-low { background: #0066ff; color: #fff; }     /* 冷門 */

        .log-item { font-size: 0.8rem; margin: 4px 0; font-family: 'Consolas'; border-left: 2px solid var(--terminal-blue); padding-left: 8px; }
        .prediction-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; display: none; margin-top: 20px; }
        .pred-card { border: 1px solid #1a2a44; padding: 15px; background: rgba(0, 40, 80, 0.2); border-left: 4px solid var(--terminal-blue); }
        
        .start-btn { width: 100%; padding: 15px; background: #004488; color: #fff; border: none; cursor: pointer; font-weight: bold; letter-spacing: 2px; transition: 0.3s; }
        .start-btn:hover { background: #00d2ff; color: #000; box-shadow: 0 0 20px #00d2ff; }
        
        .num-ball { display: inline-block; color: #fff; background: #111; padding: 4px 8px; border-radius: 4px; margin: 2px; font-size: 0.95rem; border: 1px solid #333; }
        .z2-ball { background: #cc0000; border-color: #ff4444; }
    </style>
</head>
<body>

<div class="terminal-container">
    <div style="text-align:center; margin-bottom:15px;">
        <h2 style="color:var(--terminal-blue); margin:0;">威力彩 AI 物理增益彩色熱分析系統</h2>
        <div style="font-size:0.7rem; color:#557799;">HEURISTIC PHYSICAL HEATMAP v2.8 (MULTI-COLOR ENGINE)</div>
    </div>

    <div style="display:flex; justify-content: center; gap:15px; font-size:0.7rem; margin-bottom:5px;">
        <span><span style="color:#ff0000;">■</span> 極熱</span>
        <span><span style="color:#ffaa00;">■</span> 高增益</span>
        <span><span style="color:#00ff44;">■</span> 常態</span>
        <span><span style="color:#0066ff;">■</span> 物理偏移低</span>
    </div>

    <div class="heatmap-container" id="heatmap"></div>

    <button class="start-btn" onclick="runAnalysis()">啟動全變數物理模擬分析</button>

    <div id="log-console" style="height: 100px; overflow-y: auto; margin: 15px 0; background: rgba(0,0,0,0.3); padding: 10px;"></div>

    <div id="prediction-result" class="prediction-grid">
        <div class="pred-card"><div style="color:var(--terminal-blue); font-size:0.8rem; margin-bottom:8px;">[策略 A: 穩健型]</div><div id="set1-balls"></div></div>
        <div class="pred-card"><div style="color:var(--terminal-blue); font-size:0.8rem; margin-bottom:8px;">[策略 B: 物理偏移]</div><div id="set2-balls"></div></div>
        <div class="pred-card"><div style="color:var(--terminal-blue); font-size:0.8rem; margin-bottom:8px;">[策略 C: 貝式綜合]</div><div id="set3-balls"></div></div>
        <div class="pred-card" style="border-left-color:#ff4444;"><div style="color:#ff4444; font-size:0.8rem; margin-bottom:8px;">[策略 D: 極端爆冷]</div><div id="set4-balls"></div></div>
    </div>

    <button id="receipt-btn" class="start-btn" style="display:none; margin-top:15px; background:#cc8800;" onclick="showReceipt()">生成電子投注單</button>
</div>

<script>
    // 初始化 01-38 節點
    const heatmap = document.getElementById('heatmap');
    for(let i=1; i<=38; i++) {
        let node = document.createElement('div');
        node.className = 'heat-node';
        node.id = `node-${i}`;
        node.textContent = i < 10 ? '0'+i : i;
        heatmap.appendChild(node);
    }

    async function runAnalysis() {
        const consoleElem = document.getElementById('log-console');
        consoleElem.innerHTML = "";
        
        // 模擬運算日誌
        const logs = [
            "> 正在連線至大數據物理指紋庫...",
            "> 執行 6 種組合物理偏移分析 (A/B 機台)...",
            "> 偵測到球組 S1-S3 質量不對稱性...",
            "> [驗證] 排除歷史中獎組合紀錄...",
            "> 模擬完成，輸出熱力圖權重。"
        ];

        // 隨機熱力圖動畫
        let timer = setInterval(() => {
            for(let i=1; i<=38; i++) {
                let node = document.getElementById(`node-${i}`);
                let val = Math.random();
                node.className = 'heat-node'; // 重置
                if(val > 0.85) node.classList.add('heat-extreme');
                else if(val > 0.65) node.classList.add('heat-high');
                else if(val > 0.35) node.classList.add('heat-mid');
                else node.classList.add('heat-low');
            }
        }, 80);

        for(let log of logs) {
            let d = document.createElement('div');
            d.className = 'log-item';
            d.textContent = log;
            consoleElem.appendChild(d);
            await new Promise(r => setTimeout(r, 600));
        }

        clearInterval(timer);
        displayPredictions();
    }

    function displayPredictions() {
        const gen = () => {
            let z1 = [];
            while(z1.length < 6) {
                let n = Math.floor(Math.random()*38)+1;
                if(!z1.includes(n)) z1.push(n);
            }
            return { z1: z1.sort((a,b)=>a-b), z2: Math.floor(Math.random()*8)+1 };
        };

        const render = (id, data) => {
            document.getElementById(id).innerHTML = data.z1.map(n => `<span class="num-ball">${n<10?'0'+n:n}</span>`).join('') 
                + `<span class="num-ball z2-ball">${data.z2}</span>`;
        };

        render('set1-balls', gen());
        render('set2-balls', gen());
        render('set3-balls', gen());
        render('set4-balls', gen());

        document.getElementById('prediction-result').style.display = "grid";
        document.getElementById('receipt-btn').style.display = "block";
    }
</script>
</body>
</html>
